# SQL Genius: AI-Driven Text-to-SQL RAG System

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π (**2000+ —Ç–∞–±–ª–∏—Ü**, **28,000+ –∫–æ–ª–æ–Ω–æ–∫**). 

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é –ø—Ä–æ–±–ª–µ–º—É LLM –≤ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º —Å–µ–∫—Ç–æ—Ä–µ: **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** –∏ **–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏** –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –æ–≥—Ä–æ–º–Ω—ã–º–∏ —Å—Ö–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (ML System Design)
–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö **Agentic RAG** –∏ –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —É—Ä–æ–≤–Ω–∏:

1.  **Metadata Warehouse (Local Shadow DB):** –õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ —Å–ª–µ–ø–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö (100 —Å—Ç—Ä–æ–∫ –Ω–∞ —Ç–∞–±–ª–∏—Ü—É) –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ Prod.
2.  **Semantic Schema Retriever (ChromaDB + ANN):** –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (–í–µ–∫—Ç–æ—Ä–Ω—ã–π + –ö–ª—é—á–µ–≤–æ–π) –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –∫—É—Å–∫–æ–≤ —Å—Ö–µ–º—ã (Top-K —Ç–∞–±–ª–∏—Ü).
3.  **Schema Pruning (Pydantic-Driven):** –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è: —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —Ç–∞–±–ª–∏—Ü—ã, –∑–∞—Ç–µ–º LLM –æ—Ç–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏. –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å "—à—É–º–∞" –Ω–∞ 90%.
4.  **Self-Correction Loop (LangGraph):** –¶–∏–∫–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è SQL. –ï—Å–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π –≤ "–ø–µ—Å–æ—á–Ω–∏—Ü–µ", —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç Traceback –∏ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥.

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
* **Backend:** Python 3.12, FastAPI (Async)
* **LLM Orchestration:** LangGraph, Pydantic (Structured Output)
* **Vector DB:** ChromaDB (HuggingFace Embeddings)
* **Database:** PostgreSQL 15 (Docker)
* **Infrastructure:** Docker Compose (3 —Å–µ—Ä–≤–∏—Å–∞: App, DB, VectorStore)

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Security by Design)
* **Read-Only Sandboxing:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç LLM –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å –ø—Ä–∞–≤–∞–º–∏ `SELECT ONLY`.
* **Zero-Trust Context:** LLM –Ω–µ –∏–º–µ–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–æ–µ–≤–æ–π –±–∞–∑–µ. –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–ª–µ–ø–æ–∫.
* **Environment Isolation:** –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ö–∞—Ä–¥–∫–æ–¥–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `.env`).

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å
1.  –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
2.  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `.env` (—É–∫–∞–∑–∞—Ç—å API –∫–ª—é—á–∏ OpenRouter –∏ –¥–æ—Å—Ç—É–ø –∫ –∏—Å—Ö–æ–¥–Ω–æ–π –ë–î).
3.  –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ä–∫–µ—Å—Ç—Ä:
    ```bash
    docker-compose up --build
    ```
4.  –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:
    ```bash
    docker exec -it sql_genius_app python src/ingestion/sync_metadata.py
    ```
5.  –û—Ç–∫—Ä—ã—Ç—å Swagger UI: `http://localhost:8080/docs`

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (BM25 + Vector) –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –Ω–∞ –∏–º–µ–Ω–∞—Ö —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö.
* –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ Redis.
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (PII Masking) –Ω–∞ —ç—Ç–∞–ø–µ ETL.